#include "iostream"
#include "TXLib.h"
#include "Button.h"



 int main()
 {
  txCreateWindow(800,600);
  HDC Buildings=txCreateCompatibleDC (800,600);
  HDC BuildMenu=txCreateCompatibleDC (800,600);

  //картинки начало

   HDC Menu=txLoadImage("Texture/Menu.bmp");
   HDC InformationMenu=txLoadImage("Texture/Information.bmp");
   HDC Field=txLoadImage("Texture/Field.bmp");
   HDC Nya=txLoadImage("Texture/Nya.bmp");
   HDC Sun=txLoadImage("Texture/Sun.bmp");
   HDC Delete=txLoadImage("Texture/Delete.bmp");


   HDC Building;

   HDC Building1=txLoadImage("Texture/Building1.bmp");
   HDC Building2=txLoadImage("Texture/Building2.bmp");
   HDC Building3=txLoadImage("Texture/Building3.bmp");
   HDC Building4=txLoadImage("Texture/Building4.bmp");
   HDC Building5=txLoadImage("Texture/Building5.bmp");
   HDC Building6=txLoadImage("Texture/Building6.bmp");


   HDC OMB=txLoadImage("Texture/OpenMenuBut.bmp");
   HDC MenuBut=txLoadImage("Texture/MenuBut.bmp");
   HDC TownName=txLoadImage("Texture/TownName.bmp");

  //картинки конец

  //кнопки (создание) начало

   //спрайт 1 начало

    Button NewGame(30,30,130,70,TX_BLUE);
    NewGame.textAdd("New Game");

    Button Saves(30,110,130,70,TX_BLUE);
    Saves.textAdd("Load Games");

    Button Information(30,190,130,70,TX_BLUE);
    Information.textAdd("I");

    Button Settings(30,270,130,70,TX_BLUE);
    Settings.textAdd("Settings");

    Button LeaveS1(30,520,130,70,TX_RED);
    LeaveS1.textAdd("Leave");

   //спрайт 1 конец

   //спрайт 2 начало

    //кнопки стоп меню начало

     Button Continue(260,360,280,70,TX_BLUE);
     Continue.textAdd("Continue");

     Button LeaveAndSave(260,440,280,70,TX_BLUE);
     LeaveAndSave.textAdd("Leave And Save");

     Button LeaveS2(260,520,280,70,TX_RED);
     LeaveS2.textAdd("Leave to Main Menu");

    //кнопки стоп меню конец

    //кнопки строй меню начало

     Button CategoryLive (12,462,29,17,TX_TRANSPARENT);
     CategoryLive.picterVisible=0;

     Button CategoryShops (45,462,29,17,TX_TRANSPARENT);
     CategoryShops.picterVisible=0;

     Button CategoryIndustry (77,462,29,17,TX_TRANSPARENT);
     CategoryIndustry.picterVisible=0;

     Button CategoryMed (109,462,29,17,TX_TRANSPARENT);
     CategoryMed.picterVisible=0;

     Button CategoryAntifire (141,462,29,17,TX_TRANSPARENT);
     CategoryAntifire.picterVisible=0;

     Button CategoryPolice (174,462,29,17,TX_TRANSPARENT);
     CategoryPolice.picterVisible=0;

     Button CategoryGoverment (206,462,29,17,TX_TRANSPARENT);
     CategoryGoverment.picterVisible=0;

     Button CategoryPark (239,462,29,17,TX_TRANSPARENT);
     CategoryPark.picterVisible=0;

     Button CategoryOther (272,462,29,17,TX_TRANSPARENT);
     CategoryOther.picterVisible=0;




     Button BD1_1(55,500,50,86,TX_TRANSPARENT);
     BD1_1.PicterAdd("Texture/Building1.bmp",50,86);

     Button BD1_2(115,500,50,86,TX_TRANSPARENT);
     BD1_2.PicterAdd("Texture/Building2.bmp",50,86);

     Button BD1_3(175,500,50,86,TX_TRANSPARENT);
     BD1_3.PicterAdd("Texture/Building3.bmp",50,86);

     Button BD1_4(235,500,50,86,TX_TRANSPARENT);
     BD1_4.PicterAdd("Texture/Building4.bmp",50,86);

     Button BD1_5(295,500,50,86,TX_TRANSPARENT);
     BD1_5.PicterAdd("Texture/Building5.bmp",50,86);

     Button BD1_6(355,500,50,86,TX_TRANSPARENT);
     BD1_6.PicterAdd("Texture/Building6.bmp",50,86);

    //кнопки строй меню конец

   //спрайт 2 конец

  //кнопки (создание) конец

  //создание переменных начало

   int sprite=1;//спрайта нет в России (это китайский)
   int Win2_Visible=0;//течение времени (0-время идет)
   int Zapret=0;//Запрещает строить на кнопках Строй.меню
   int PokazMenu=0;//Показывает/убирает меню
   int CoorPaintBuildingsW=800;
   int CoorPaintBuildingsH=600;
   int m=0;
   int m1=1;
   int Category=1;
   int BuildingNumber=1;
   int BuildingW=50;
   int BuildingH=86;
   Building=Building1;

  //создание переменных конец






  while(1)
  {
   txClear();
   txBegin();

   if (sprite==1)
    {//гл меню
     txSetColor(TX_WHITE);
     txSelectFont("Arial",40,10);

     txBitBlt(txDC(),0,0,800,600,Menu);

   //кнопки (текст/рисовка) начало

     NewGame.Draw();
     if (NewGame.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) sprite=2;

     Saves.Draw();
     if (Saves.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) sprite=3;

     Information.Draw();
     if (Information.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) sprite=4;

     Settings.Draw();
     if (Settings.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) sprite=5;

     LeaveS1.Draw();
     if (LeaveS1.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) sprite=6;

   //кнопки (текст/рисовка) конец

   //Название города начало
    txSetColor(TX_GREEN);
    txSelectFont("Arial",60,30);
    txTextOut(220,480,"Curved Skylines");
   //Название города конец

   //Версия игры начало
    txSetColor(TX_GREEN);
    txSelectFont("Arial",10,10);
    txTextOut(700,590,"v Beta 1.0");
   //Версия игры конец


  }

   if (sprite==2)
    {//игра
      txBitBlt(txDC(),0,0,800,600,Field);
      txTransparentBlt (700,0,Sun,TX_WHITE);
      txTransparentBlt (0,0,OMB,TX_WHITE);

     if (Win2_Visible)// если время остановленно
      {
        txTransparentBlt(txDC(),0,0,800,600,Buildings,0,0,TX_BLACK);

        txSetColor(TX_BLUE);
        txSelectFont("Arial",40,10);

        txDrawText (310,300,500,330,"Curved Skylines");

        txSetColor(TX_WHITE);
      //кнопки (текст/рисовка) начало
       Continue.Draw();
       if (Continue.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) Win2_Visible=0;

       LeaveAndSave.Draw();
       if (LeaveAndSave.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) txMessageBox("Sorry.Function is development.");

       LeaveS2.Draw();
       if (LeaveS2.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) sprite=1;
      //кнопки (текст/рисовка) конец

       if (GetAsyncKeyState(VK_ESCAPE)) Win2_Visible=0;
       txSleep(65);
     }

     if (!Win2_Visible)//если время не остановленно
     {


      if (GetAsyncKeyState('M')) { m=1; m1=1;};


      if (txMouseButtons()==1)
      {
       if (txMouseY()<1.2*txMouseX()+50&&txMouseY()>1.2*txMouseX()-470&&txMouseY()>-0.1*txMouseX()+50&&txMouseY()<-0.1*txMouseX()+500&&Zapret==0)
         {
         // cout<<2*txMouseX()+81<<"  "<<txMouseY()  <<std::endl;
         // ТУТ ЗАДА РАЗМЕРЫ 50 86 ЧЕРЕЗ ПЕРЕМЕННЫЕ

          txTransparentBlt(Buildings,txMouseX(),txMouseY(),BuildingW,BuildingH,Building,0,0,TX_WHITE);
         }
      }


       Zapret=0;


      if (txMouseButtons()==1||m)

      {
       if(PokazMenu==0)
        {
         CoorPaintBuildingsW=800;
         CoorPaintBuildingsH=600;

        if ((txMouseX()>0&&txMouseY()>0&&txMouseX()<50&&txMouseY()<50 )|| m)
         {
         txTransparentBlt(BuildMenu,0,450,800,150,MenuBut,0,0,TX_WHITE);
         Zapret=1;
         m1=0;
         PokazMenu=1;

         txSleep(100);

         }
       }







       }

        if(PokazMenu==1)
        {
        txTransparentBlt(txDC(),0,0,800,600,BuildMenu,0,0,TX_BLACK);
        CoorPaintBuildingsH=450;


            if (txMouseButtons()==1&&txMouseX()>0&&txMouseY()>0&&txMouseX()<50&&txMouseY()<50||(m&&m1))
                     {

                     PokazMenu=0;
                     m=0;
                     txSleep(100);
                     }


        CategoryLive.Draw();
        if (CategoryLive.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) Category=1;

        CategoryShops.Draw();
        if (CategoryShops.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) Category=2;

        CategoryIndustry.Draw();
        if (CategoryIndustry.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) Category=3;

        CategoryMed.Draw();
        if (CategoryMed.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) Category=4;

        CategoryAntifire.Draw();
        if (CategoryAntifire.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) Category=5;

        CategoryPolice.Draw();
        if (CategoryPolice.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) Category=6;

        CategoryGoverment.Draw();
        if (CategoryGoverment.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) Category=7;

        CategoryPark.Draw();
        if (CategoryPark.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) Category=8;

        CategoryOther.Draw();
        if (CategoryOther.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1) Category=9;






        switch (Category)
          { case 1:

            BD1_1.Draw();

            BD1_2.Draw();

            BD1_3.Draw();

            BD1_4.Draw();

            BD1_5.Draw();

            BD1_6.Draw();

            if (BD1_1.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1)
            {   BuildingW=50;
                BuildingH=86;
                Building=Building1;
                break;}

            if (BD1_2.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1)
            {   BuildingW=50;
                BuildingH=86;
                Building=Building2;
                break;}

            if (BD1_3.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1)
            {   BuildingW=50;
                BuildingH=86;
                Building=Building3;
                break;}

            if (BD1_4.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1)
            {   BuildingW=50;
                BuildingH=86;
                Building=Building4;
                break;}

            if (BD1_5.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1)
            {   BuildingW=50;
                BuildingH=86;
                Building=Building5;
                break;}

            if (BD1_6.BClick(txMouseX(),txMouseY())&&txMouseButtons()==1)
            {   BuildingW=50;
                BuildingH=86;
                Building=Building6;
                break;}


            break;
           }





















         if (txMouseButtons()==1&&txMouseX()>0&&txMouseY()>450&&txMouseX()<800&&txMouseX()<600)
          Zapret=1;


       if (txMouseButtons()==2)
       {
        txSetColor(TX_BLACK);
        txSetFillColor(TX_BLACK);

        txBitBlt(Buildings,txMouseX(),txMouseY(),40,55,Delete);
        txRectangle(txMouseX(),txMouseY(),txMouseX()+40,txMouseY()+55);
       }





    }
    txTransparentBlt(txDC(),0,0,CoorPaintBuildingsW,CoorPaintBuildingsH,Buildings,0,0,TX_BLACK);

      if (GetAsyncKeyState(VK_ESCAPE)) Win2_Visible=1;
      txSleep(65);


   }
   }

  if (sprite==3)
  {
  cout<<sprite;
  }

  if (sprite==4)
   {//сведения
     txBitBlt(txDC(),0,0,800,600,InformationMenu);


     if (GetAsyncKeyState(VK_ESCAPE)) sprite=1;
   }

 if (sprite==6)
  {//выход
   txSetFillColor(TX_WHITE);

   txBitBlt(txDC(),0,50,800,600,Nya);

   if (GetAsyncKeyState(VK_ESCAPE)) sprite=1;



  }

  txEnd();
  }
 }//счастливый конец
